{% extends "base.jinja" %}

{% from "components/meta_tags.jinja" import MetaTags with context %}
{% from "components/comments.jinja" import Comments with context %}
{% from "components/blog_posting_meta.jinja" import BlogPostingMeta with context %}

{% block head %}
{{ super() }}
{{ MetaTags(blog_posting) }}
{% endblock head %}

{% block title %}
{{ blog_posting.meta_title }}
{% endblock title %}

{% block content %}
<main class="f-box" style="--box-padding: calc(4 * var(--w)) 0">
  {%- if blog_posting.is_private -%}
    <p class="f-text-danger f-center f-box" style="--box-padding: var(--w)">
      {{ _("This is a private link: please do not share!") }}
    </p>
  {%- endif -%}

  <div class="f-container f-stack" style="--stack-gap: calc(2 * var(--w))">
    <div class="f-stack">
      {{ BlogPostingMeta(blog_posting, editable=true) }}

      <h1>
        {{ blog_posting.name }}
      </h1>

      {% if blog_posting.abstract -%}
        <p class="fr-text-muted">
          {{ blog_posting.abstract }}
        </p>
      {%- endif %}

      {% if blog_posting.image -%}
        <div class="f-image">
          <img src="{{ blog_posting.image.content_url }}" alt="{{ blog_posting.image.caption or '' }}" />

          {% if blog_posting.image.caption -%}
            <figcaption>
              {{ blog_posting.image.caption }}
            </figcaption>
          {%- endif %}
        </div>
      {%- endif %}
    </div>

    <hr>

    <div class="f-container f-markdown" style="--container-width: calc(100 * var(--w))">
      {{ blog_posting.text | safe }}
    </div>

    <div class="f-print-hidden">
      {{ Comments() }}
    </div>
  </div>
</main>
{% endblock content %}
